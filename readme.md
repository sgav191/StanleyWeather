Important Notes: This code is currently broken. I will update it when I have time.